<template>  <vue-easy-print tableShow ref="easyPrint" >    <div id="printModel" class="c_p_n c_box c_auto_y">      <!--<h2 class="c_center">{{ headerTableSelectionData.purpose }}</h2>-->      <div class="c_flex c_item_center">        <div style="flex: 4"><h1 class="c_center">收入确认单</h1></div>        <!--<div style="flex: 1" class="c_left">-->          <!--<div>合同编号： {{headerTableSelectionData.ht}}</div>-->          <!--<div class="c_m_t_n">项目： {{headerTableSelectionData.xmname}}</div>-->        <!--</div>-->      </div>      <!--其他信息-->      <div class="c_m_t_n c_flex">        <div style="flex: 2">单据编号： {{headerTableSelectionData.vbillno}}</div>        <div style="flex: 2">单据日期： {{headerTableSelectionData.dbilldate}}</div>        <div style="flex: 1"></div>      </div>      <div class="to-table c_m_t_n c_flex c_item_center">        <div style="flex: 1">部门：</div>        <div style="flex: 2">{{headerTableSelectionData.deptname}}</div>        <div style="flex: 1">提交人：</div>        <div style="flex: 2">{{headerTableSelectionData.submittername}}</div>        <div style="flex: 1">是否开票：</div>        <div style="flex: 3">{{headerTableSelectionData.isinvoice === 'Y' ? '是' : '否' }}</div>      </div>      <div class="to-table c_m_t_n c_flex c_item_center">        <div style="flex: 1">指派经办人：</div>        <div style="flex: 2">{{headerTableSelectionData.operatorname}}</div>        <div style="flex: 1">指派财务：</div>        <div style="flex: 2">{{headerTableSelectionData.financename}}</div>        <div style="flex: 1">备注：</div>        <div style="flex: 3">{{headerTableSelectionData.memo}}</div>      </div>      <!--表体-->      <div class="c_m_t_n">        <!--新版打印-->        <el-table style="width: 100%" size="small" border show-summary :summary-method="getSummaries" :data="tableBodyData">          <template v-for="(item, i) in tableBodyParam.list">            <el-table-column v-if="item.key === 'rowno'" :key="i" :label="item.name" :prop="item.key">              <template slot-scope="scope">                {{ scope.$index + 1}}              </template>            </el-table-column>            <template v-else-if="item.isTitle">              <el-table-column :key="i" :label="item.name" align="center" :min-width="item.minWidth">                <template v-for="(subItem, sub) in item.children">                  <el-table-column :key="i + '-' + sub" :min-width="subItem.minWidth" :label="subItem.name" :prop="subItem.key"></el-table-column>                </template>              </el-table-column>            </template>            <el-table-column v-else :key="i" :min-width="item.minWidth" :label="item.name" :prop="item.key"></el-table-column>          </template>        </el-table>      </div>      <!--<div class="to-table c_m_t_n c_flex c_item_center">-->        <!--<div style="flex: 1">报销总计: {{ headerTableSelectionData.bxje }}</div>-->        <!--<div style="flex: 6; text-align: center">{{ headerTableSelectionData.totalSkToCap }} </div>-->        <!--<div style="flex: 1; text-align: center">¥</div>-->        <!--<div style="flex: 2; text-align: center">{{ headerTableSelectionData.totalSk || 0 }} </div>-->      <!--</div>-->      <!--其他信息-->      <div class="c_m_t_n c_flex c_item_center">        <div style="flex: 1.6">部门负责人： </div>        <div style="flex: 1.6">财务审核人： </div>        <div style="flex: 1.6">财务负责人： </div>        <div style="flex: 1.6">分管副院长： </div>        <div style="flex: 1.6">院长： </div>        <div style="flex: 1.6">报销人： </div>      </div>      <div class="c_m_t_20 c_flex c_item_center">        <div style="flex: 9">本人承诺所附单据真实合法有效！ </div>        <div style="flex: 1">承诺人： </div>      </div>    </div>  </vue-easy-print></template><script>  import vueEasyPrint from "vue-easy-print";  export default {    name: "printTravelExpenses",    components: { vueEasyPrint },    data() {      return {        visible: true,        // 表体参数        // -- 表格参数        tableBodyParam: {          list: [            { name: '客商', key: 'custname', minWidth: '100', isUse: true },            { name: '项目', key: 'jobname', minWidth: '100', isUse: true },            { name: '金额(元)', key: 'amount', minWidth: '100', isUse: true },            { name: '备注', key: 'memo', minWidth: '100', isUse: true }          ]        },        headerTableSelectionData: {},        // -- 表格列表数据        tableBodyData: [],      }    },    created() {      // this.tableBodyData = JSON.parse(this.$route.query.tableBodyData);      // this.headerTableSelectionData = JSON.parse(this.$route.query.headerTableSelectionData);      let tableBodyData = sessionStorage['tableBodyData']      let headerTableSelectionData = sessionStorage['headerTableSelectionData']      this.tableBodyData = JSON.parse(tableBodyData);      this.headerTableSelectionData = JSON.parse(headerTableSelectionData);      // 金额大写      this.headerTableSelectionData.totalSkToCap = this.$util.changeNumMoneyToChinese(this.headerTableSelectionData.totalSk)    },    mounted() {      // window.print();//调用打印的窗口      this.printView()    },    methods: {      open(tableBodyData, headerTableSelectionData) {        // this.tableBodyData = tableBodyData;        // this.headerTableSelectionData = headerTableSelectionData;        this.visible = true      },      cancel() {        this.tableBodyData = [];        this.headerTableSelectionData = {};        this.visible = false      },      // 表体合计: sk：收款人信息， fy：费用      getSummaries(param) {        const { columns, data } = param;        const sums = [];        columns.forEach((column, index) => {          if (index === 0) {            sums[index] = '合计';            return;          }          if (![2].includes(index)) {            return;          }          const values = data.map(item => Number(item[column.property]));          if (!values.every(value => isNaN(value))) {            sums[index] = values.reduce((prev, curr) => {              const value = Number(curr);              if (!isNaN(value)) {                return prev + curr;              } else {                return prev;              }            }, 0);            sums[index] = +(sums[index].toFixed(2))            sums[index] += ' 元';          } else {            sums[index] = '';          }        });        return sums;      },      // 打印      printView() {        this.$nextTick(() => {          this.$refs.easyPrint.print()        })      }    }  }</script><style scoped>.to-table{  border:1px solid #ebeef5 ;}.to-table div{  height: 100%;  padding: 12px 10px;  min-width: 0;  box-sizing: border-box;  text-overflow: ellipsis;  vertical-align: middle;  text-align: left;  border-left:1px solid #ebeef5 ;  margin-left: -1px;}</style>