<template>  <!--查询-->  <el-dialog    title="查询条件"    :modal-append-to-body="false"    :append-to-body="false"    :modal="false"    :visible.sync="param.visible"  >    <el-form label-position="left" inline class="demo-table-expand">      <template v-for="(item,i) in param.list">        <template v-if="item.type === 'date'">          <el-form-item :label="item.name">            <el-date-picker              v-model="queryData[item.key]"              type="daterange"              size="small"              clearable              value-format="yyyy-MM-dd"              range-separator="至"              start-placeholder="开始日期"              end-placeholder="结束日期">            </el-date-picker>          </el-form-item>        </template>        <template v-else-if="item.type === 'bxr'">          <el-form-item :label="item.name">            <el-input              size="small"              readonly              suffix-icon="el-icon-search"              v-model="queryData[item.key]"              v-on:click.native="handleBxrname"></el-input>          </el-form-item>        </template>        <template v-else-if="item.type === 'approvestatus'">          <el-form-item :label="item.name">            <el-select style="width: 100px" size="small" readonly clearable v-model="queryData[item.key]">              <el-option                v-for="item in dataSource.approvestatusList"                :key="item.value"                :label="item.label"                :value="item.value">              </el-option>            </el-select>          </el-form-item>        </template>        <template v-else>          <el-form-item :label="item.name">            <el-input size="small" clearable v-model="queryData[item.key]"></el-input>          </el-form-item>        </template>      </template>    </el-form>    <span slot="footer" class="dialog-footer">        <el-button size="small" @click="param.visible = false">取 消</el-button>        <el-button type="primary" size="small" @click="confirmSelect">确 定</el-button>    </span>    <!--报销人-->    <bxrname-select ref="bxrnameSelect" @confirm="confirmBxrname"></bxrname-select>  </el-dialog></template><script>  import bxrnameSelect from './bxrSelect'  export default {    name: "select",    components: { bxrnameSelect },    data() {      return {        param: {          visible: false,          list: [            // {"key":"name","operation":"=","value":"张三"},            { name: '单据日期', "key":"dbilldate","operation":">=","value":"", type: 'date'},            { name: '单据号', "key":"vbillno", "operation":"=" },            { name: '报销人', "key":"bxrname", "operation":"=", type: 'bxr' },            { name: '报销金额', "key":"def7", "operation":"=" },            { name: '已办/未办', "key":"approvestatus", "operation":"=", type: 'approvestatus' },          ]        },        queryData: {          vbillno: '',          bxr: '',          bxrname: '',          dbilldate: [            this.$util.timeFormat('', 'date'),            this.$util.timeFormat('', 'date')          ]        },        dataSource: {          approvestatusList: [            { value: 1, label: '未办' }, // = 0            { value: 2, label: '已办' }, // <> 0            { value: 3, label: '全部' } // ''          ]        },      }    },    methods: {      open(row, api) {        this.param.visible = true        this.api = api      },      close() {        this.param.visible = false      },      confirmSelect() {        if (!this.queryData.dbilldate[0] || !this.queryData.dbilldate[1]) {          return this.$message({ message: '请选择日期', duration: 1000 })        }        const data = {          action: 'query',          data: [            { key: "tra.dbilldate", operation: ">=", value: this.queryData.dbilldate[0]},            { key: "tra.dbilldate", operation: "<=", value: this.queryData.dbilldate[1]},            { key: "tra.vbillno", operation: "=", value: this.queryData.vbillno },            { key: "tra.bxr", operation: "=", value: this.queryData.bxr },            { key: "tra.def7", operation: "=", value: +this.queryData.def7 },            { key: "pwf.approvestatus",              operation: this.queryData.approvestatus === 1 ? "=" : this.queryData.approvestatus === 2 ? '<>' : '',              value: 0            },          ]        }        this.$emit('confirm', data)        this.close()      },      // 选择报销人      handleBxrname() {        this.$refs.bxrnameSelect.open(this.api.getData)      },      // 提交报销人      confirmBxrname(data) {        this.queryData = {          ...this.queryData,          bxrname: data.bxrname,          bxr: data.bxr        }      }    }  }</script><style scoped></style>